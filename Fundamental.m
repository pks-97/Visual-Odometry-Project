function [R,T]=Fundamental()
I1=rgb2gray(imread('frame0001.jpg'));
I2=rgb2gray(imread('frame0002.jpg'));
points1=detectSURFFeatures(I1);
points2=detectSURFFeatures(I2);
[features1,valid_points1]=extractFeatures(I1,points1);
[features2,valid_points2]=extractFeatures(I2,points2);
indexPairs=matchFeatures(features1,features2);
matchedPoints1 = valid_points1(indexPairs(:,1));
matchedPoints2 = valid_points2(indexPairs(:,2));
a=matchedPoints1(:).Location;
b=matchedPoints2(:).Location;
[m1,m2]=Mean(a);
[m3,m4]=Mean(b);
d1=Avg_Distance(a,m1,m2);
d2=Avg_Distance(a,m3,m4);
scale1=sqrt(2)/d1;
scale2=sqrt(2)/d2;
T1=[scale1,0,-scale1*m1;0,scale1,-scale1*m2;0,0,1];
T2=[scale2,0,-scale2*m3;0,scale2,-scale2*m4;0,0,1];
[x1,y1]=size(a);
[x2,y2]=size(b);
a1=ones(3,x1);
b1=ones(3,x2);
a1(1:2,:)=a';
b1(1:2,:)=b';
a1=T1*a1;
b1=T2*b1;
A=ones(8,9);
for i=1:8
    A(i,1)=a1(1,i)*b1(1,i);
    A(i,2)=a1(1,i)*b1(2,i);
    A(i,3)=a1(1,i);
    A(i,4)=b1(1,i)*a1(2,i);
    A(i,5)=a1(2,i)*b1(2,i);
    A(i,6)=a1(2,i);
    A(i,7)=b1(1,i);
    A(i,8)=b1(2,i);
    A(i,9)=1;
end    
[U,D,V]=svd(A);
[~,solColV]=min(diag(D));
F_est=[V(1:3,solColV)';V(4:6,solColV)';V(7:9,solColV)'];
if(rank(F_est) ==3)
    [u,d,v]=svd(F_est);
    d(3,3)=0;
    %e=(d(1,1) + d(2,2))/2;
    %d(1,1)=e;
    %d(2,2)=e;
    F_est=u*d*v';
end
K=[406.952636, 0.000000, 366.184147; 0.000000, 405.671292, 244.705127; 0.000000, 0.000000, 1.000000];
E=K'*F_est*K;
[u,d,v]=svd(E);
d(3,3)=0;
e=(d(1,1) + d(2,2))/2;
d(1,1)=e;
d(2,2)=e;
E=u*d*v';
a2=a1(:,8);
b2=b1(:,8);
[R,T]=decomposeEssentialMatrix(E,a1,b1,K);
end